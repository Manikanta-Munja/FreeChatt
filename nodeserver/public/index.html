<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyChat Node Application socket.io </title>
   <script defer src="/socket.io/socket.io.js"></script>
   <script defer src="client.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
       <nav>
        <img src="chat.jpeg" alt="">
       </nav>
       <div class="container">const express = require('express');
        const app = express();
        const http = require('http').createServer(app);
        const io = require('socket.io')(http, {
            cors: {
                origin: "*",  // Allow requests from any origin
                methods: ["GET", "POST"]
            }
        });
        const cors = require('cors');
        
        app.use(cors());  // Enable CORS for all routes
        app.use(express.static(__dirname));  // Serve static files
        
        const users = {};
        
        io.on('connection', socket => {
        
            console.log("A new user connected:", socket.id);
        
            socket.on('new-user-joined', Name => {
                users[socket.id] = Name;
                console.log("new_user", Name);
                socket.broadcast.emit('user-joined', Name);
            });
            socket.on('send', message => {
                const data = { message: message, Name: users[socket.id] };
                socket.broadcast.emit('receive', data);  // Sends to others
                // socket.emit('receive', data);  // Sends back to sender
            });
            
            socket.on('disconnect', () => {
                socket.broadcast.emit('left',users[socket.id]);
                console.log(`${users[socket.id]} left the chat`);
                delete users[socket.id];
            });
        });
        
        http.listen(8000, () => {
            console.log("Server running at http://localhost:8000");
        });
        
            <!-- <div class="message right">mani: hi how are you</div>
           <div class="message left">mani2: yeah iam fine how about you</div> -->
       </div>
                   
       <div id="send-container">
        <form action="#" id="sender">
            <input type="text" id="sendmsg" name="sendmsg">
            <button type="submit" id="btn">send</button></form>
       

       </div>
</body>
</html>
